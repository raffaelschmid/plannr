<?xml version="1.0" encoding="utf-8"?>
<s:NavigatorContent label="Scheduler" width="100%" height="100%"  
					xmlns:fx="http://ns.adobe.com/mxml/2009" 
					xmlns:s="library://ns.adobe.com/flex/spark" 
					xmlns:mx="library://ns.adobe.com/flex/mx" 
					xmlns:ibm="http://www.ibm.com/xmlns/prod/ilog/elixir/2010"
					 xmlns:ilog="http://www.ilog.com/2007/ilog/flex"
					 xmlns:local="ch.plannr.view.renderer.*" >
	<fx:Script>
		<![CDATA[
			import ilog.calendar.CalendarItem;
			
			import mx.controls.Alert;
			
			import spark.events.IndexChangeEvent;
			
			/**
			 * List of calendars 
			 */ 
			[Bindable]  
			private var calendars:Array = [
				{ id: "0", label: "professional", color:0x6B56BB},
				{ id: "1", label: "personal", color:0x2B8F40},        
			];   
		
			[Bindable]
			private var totalPrice:Number = 0.00;
		
			protected function itemIndexChangeHandler(event:IndexChangeEvent):void
			{
				schedulerViewStack.selectedChild=overlays.selectedItem.show;
			}
			
			private function itemColorFunction(calItem:CalendarItem):Object {
				
				var now:Date = new Date();
				
				if (calItem.endTime < now) {
					return 0x555555;
				} else {
					var index:int = parseInt(calItem.calendar as String);
					return calendars[index].color;        
				}
			}
			
			private function zoomInCalendar():void {
				if (cal.mode != Calendar.MONTH_MODE) {                   
					zoomInButton.enabled = cal.zoom(2, true);
					zoomOutButton.enabled = true;                    
				}
			}
			
			private function zoomOutCalendar():void {
				if (cal.mode != Calendar.MONTH_MODE) {          
					zoomOutButton.enabled = cal.zoom(0.5, true);
					zoomInButton.enabled = true;          
				}        
			}
			
			private function moveToCurrentDay():void {
				
				cal.date = new Date();
				cal.mode = Calendar.DAY_MODE;                                   
			}
			
			private function toggleMode(event:ItemClickEvent):void {
				if (cal.date == null) {          
					cal.date = cal.endDate;              
				}
				cal.mode = modes[event.index];
				
				cal.rowHeaderEnabled = cal.mode == Calendar.MONTH_MODE;
				cal.columnHeaderEnabled = cal.mode != Calendar.MONTH_MODE;
			}
			
		]]>
	</fx:Script>
	<mx:HBox height="100%" width="100%">
		<mx:HBox width="20%" height="100%">
			<mx:Form>
				<mx:FormItem label="Overlays">
					<s:List change="itemIndexChangeHandler(event)" id="overlays" labelField="label" width="100%" height="40%">
						<s:ArrayCollection>
							<fx:Object show="{all}" label="All"></fx:Object>
							<fx:Object show="{vacation}" label="Vacation"></fx:Object>
						</s:ArrayCollection>
					</s:List>
				</mx:FormItem>
			</mx:Form>
		</mx:HBox>
		<mx:ViewStack id="schedulerViewStack" 
					  borderStyle="solid" 
					  width="80%" height="100%">
			<mx:VDividedBox width="100%" height="100%" label="All" id="all"  paddingLeft="10" paddingBottom="10" paddingRight="10" paddingTop="10">
				<s:BorderContainer>
					<s:layout><s:HorizontalLayout/></s:layout>
					<mx:HBox id="box" right="0" bottom="0">
						
						<mx:Button id="zoomInButton" width="36" icon="@Embed(source='../resources/zoom.png')" click="zoomInCalendar()" />
						<mx:Button id="zoomOutButton" width="36" icon="@Embed(source='../resources/unzoom.png')" click="zoomOutCalendar()" />
						<mx:Box width="20" height="10" />
						
						<mx:Button id="prevButton" height="22" skin="ilog.skins.PreviousArrowSkin" click="cal.previousRange()"  />
						<mx:Button id="nextButton" height="22" skin="ilog.skins.NextArrowSkin" click="cal.nextRange()"  /> 
						<mx:Button label="@Resource(bundle='calendarsample', key='calendarsample.button.Today')" click="moveToCurrentDay()" />
						<mx:Box width="5" height="10" />
						
						<mx:ToggleButtonBar id="toggleModeBar" itemClick="toggleMode(event)"/>            
						
					</mx:HBox>
				</s:BorderContainer>
				<mx:HBox width="100%" height="60%">
					<ilog:Calendar id="cal" width="100%" height="100%"                                           
								   animationDuration="1000"                     
								   doubleClickEnabled="true"
								   itemColorFunction="{itemColorFunction}"                      
								   allowMultipleSelection="false"                                                 
								   startDisplayedTime="[8,0]"
								   endDisplayedTime="[18,0]"
								   showItemIndicators="true"
								   columnHeaderEnabled="true">
						<ilog:currentTimeIndicatorStroke >
							<mx:SolidColorStroke alpha="0.8" color="#9C35BE" weight="2" caps="none" />
						</ilog:currentTimeIndicatorStroke>
						
						<ilog:workingTimes>
							<fx:Object rangeStart="8:00" rangeEnd="18:00"/>
						</ilog:workingTimes>  
						
						<ilog:itemVerticalRenderer>
							<fx:Component>
								<ilog:CalendarItemVerticalRenderer/>
							</fx:Component>
						</ilog:itemVerticalRenderer>                       
						
					</ilog:Calendar>           
									</mx:HBox>
				<mx:HBox width="100%" height="40%">
					<mx:VBox width="50%" height="200">
						<mx:Form width="100%" height="100%">
							<mx:FormItem label="Title">
								<s:TextInput width="100%"/>
							</mx:FormItem>
							<mx:FormItem label="Description">
								<s:TextArea height="100" width="100%"/>
							</mx:FormItem>
						</mx:Form>
					</mx:VBox>
					<mx:VBox width="50%" height="200">
						<mx:Form width="100%" height="100%">
							<mx:FormItem label="From">
								<mx:DateField/>
							</mx:FormItem>
							<mx:FormItem label="To">
								<mx:DateField/>
							</mx:FormItem>
						</mx:Form>
					</mx:VBox>
				</mx:HBox>
			</mx:VDividedBox>
			<mx:VDividedBox width="100%" height="100%" label="All" id="vacation"  paddingLeft="10" paddingBottom="10" paddingRight="10" paddingTop="10">
			</mx:VDividedBox>
		</mx:ViewStack>
	</mx:HBox>
</s:NavigatorContent>
