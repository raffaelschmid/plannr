<?xml version="1.0" encoding="utf-8"?>
<!--
///////////////////////////////////////////////////////////////////////////////
// Licensed Materials - Property of IBM
// 5724-Y31,5724-Z78
// Â© Copyright IBM Corporation 2007, 2010. All Rights Reserved.
//
// Note to U.S. Government Users Restricted Rights:
// Use, duplication or disclosure restricted by GSA ADP Schedule
// Contract with IBM Corp.
///////////////////////////////////////////////////////////////////////////////
-->
<local:ExpandCollapseEventRenderer 
                xmlns:fx="http://ns.adobe.com/mxml/2009" 
                xmlns:s="library://ns.adobe.com/flex/spark" 
                xmlns:local="*"
                xmlns:mx="library://ns.adobe.com/flex/mx"
                depth="1" depth.expanded="2" 
                click="expanded = !expanded"
                currentStateChange="updateLabel(event)" 
                contentBackgroundColor="{getBackground(data)}">
  <fx:Script>
    <![CDATA[
      import mx.core.UIComponent;
      import mx.events.StateChangeEvent;

    
      static private const contentFill:Array = ["bgFill", "bgFillE"];
      
      /**
       * @private 
       */
      override protected function get backgroundItems():Array {return contentFill};
      
      static private const borderStroke:Array = ["bStroke", "bStrokeE"];
      
      /**
       * @private
       */
      override protected function get borderItems():Array {return borderStroke};
      
      private function updateLabel(event:StateChangeEvent):void {
        if (event.newState == "expanded") {
          // do not use binding to update the label to improve performances
          label.text = resourceManager.getString("timelinesample", "timelinesample.renderer.text", 
            [ data.@date, data.city, data.state ]);        }
      }
      
      private function getBackground(item:Object):uint {
        // if this is a plant let's choose a different
        // background color
        if (item.@plant == "true")
          return 0x449BD5;
        else
          return 0x9AC5E6;
      }
    ]]>
  </fx:Script>
  
  <local:states>
    <s:State name="normal" />
    <s:State name="selected"/>
    <s:State name="expanded"/>
  </local:states>  
  
  <s:Path data="L 15 0 L 7 10 L 0 0" visible.expanded="false">
    <s:stroke>
      <!--- @private -->
      <s:SolidColorStroke id="bStroke" pixelHinting="true"/>      
    </s:stroke>
    <s:fill>
      <!--- @private -->
      <s:SolidColor id="bgFill" />
    </s:fill>
  </s:Path>    
  
  <!-- when expanded display differently -->
  
  <s:Rect id="background" top="0" left="0" right="0" bottom="0" radiusX="5" visible.expanded="true"
          includeInLayout.expanded="true" visible="false" includeInLayout="false">
    <s:stroke>
      <s:SolidColorStroke id="bStrokeE" pixelHinting="true"/>      
    </s:stroke>
    <s:fill>
      <s:SolidColor id="bgFillE"/>
    </s:fill>
  </s:Rect>
  
  <s:VGroup top="0" left="0" right="0" bottom="0" 
            paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5"
            visible.expanded="true" includeInLayout.expanded="true" 
            visible="false" includeInLayout="false">
    <mx:Image source="@Embed('../resources/expandCollapseIcons.swf#expand')" 
              source.expanded="@Embed('../resources/expandCollapseIcons.swf#collapse')"/>
    <s:Label id="label"
             fontSize="30" width="200"/>    
  </s:VGroup>  

</local:ExpandCollapseEventRenderer>
